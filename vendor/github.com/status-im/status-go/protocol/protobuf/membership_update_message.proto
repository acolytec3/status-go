syntax = "proto3";

package protobuf;

import "chat_message.proto";

message MembershipUpdateEvent {
  // Lamport timestamp of the event
  uint64 clock = 1;
  // List of public keys of objects of the action
  repeated string members = 2;
  string member = 3;
  // Name of the chat for the CHAT_CREATED/NAME_CHANGED event types
  string name = 4;
  // The type of the event
  EventType type = 5;

  enum EventType {
    UNKNOWN = 0;
    CHAT_CREATED = 1;
    NAME_CHANGED = 2;
    MEMBERS_ADDED = 3;
    MEMBER_JOINED = 4;
    MEMBER_REMOVED = 5;
    ADMINS_ADDED = 6;
    ADMIN_REMOVED = 7;
  }
}

message MembershipUpdate {
  // Signature of the concatenated array bytes of the events
  string signature = 1;
  // The protobuf encoded events
  repeated MembershipUpdateEvent events = 2;
}

// MembershipUpdateMessage is a message used to propagate information
// about group membership changes.
// For more information, see https://github.com/status-im/specs/blob/master/status-group-chats-spec.md.
message MembershipUpdateMessage {
  // The chat id of the private group chat
  string chat_id = 1;
  // A list of updates for this group chat
  repeated MembershipUpdate updates = 2;
  // An optional chat message
  ChatMessage message = 3;
}
